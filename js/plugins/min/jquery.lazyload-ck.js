!function(e){"function"==typeof define&&define.amd?define(e):window.Blazy=e()}(function(){function e(e){if(!document.querySelectorAll){var r=document.createStyleSheet();document.querySelectorAll=function(e,t,n,o,s){for(s=document.all,t=[],e=e.replace(/\[for\b/gi,"[htmlFor").split(","),n=e.length;n--;){for(r.addRule(e[n],"k:v"),o=s.length;o--;)s[o].currentStyle.k&&t.push(s[o]);r.removeRule(0)}return t}}h=!0,p=[],f=e||{},f.error=f.error||!1,f.offset=f.offset||100,f.success=f.success||!1,f.selector=f.selector||".b-lazy",f.separator=f.separator||"|",f.container=f.container?document.querySelectorAll(f.container):!1,f.errorClass=f.errorClass||"b-error",f.breakpoints=f.breakpoints||!1,f.successClass=f.successClass||"b-loaded",f.src=u=f.src||"data-src",w=1<window.devicePixelRatio,g=l(n,25),y=l(s,50),s(),a(f.breakpoints,function(e){return e.width>=window.screen.width?(u=e.src,!1):void 0}),t()}function t(){o(f.selector),h&&(h=!1,f.container&&a(f.container,function(e){c(e,"scroll",g)}),c(window,"resize",y),c(window,"resize",g),c(window,"scroll",g)),n()}function n(){for(var t=0;v>t;t++){var n=p[t],r=n.getBoundingClientRect(),o=m+f.offset;(0<=r.left&&r.right<=d+f.offset&&(0<=r.top&&r.top<=o||r.bottom<=o&&r.bottom>=0-f.offset)||-1!==(" "+n.className+" ").indexOf(" "+f.successClass+" "))&&(e.prototype.load(n),p.splice(t,1),v--,t--)}0===v&&e.prototype.destroy()}function r(e){if(0<e.offsetWidth&&0<e.offsetHeight){var t=e.getAttribute(u)||e.getAttribute(f.src);if(t){var t=t.split(f.separator),n=t[w&&1<t.length?1:0],t=new Image;a(f.breakpoints,function(t){e.removeAttribute(t.src)}),e.removeAttribute(f.src),t.onerror=function(){f.error&&f.error(e,"invalid"),e.className=e.className+" "+f.errorClass},t.onload=function(){"img"===e.nodeName.toLowerCase()?e.src=n:e.style.backgroundImage='url("'+n+'")',e.className=e.className+" "+f.successClass,f.success&&f.success(e)},t.src=n}else f.error&&f.error(e,"missing"),e.className=e.className+" "+f.errorClass}}function o(e){e=document.querySelectorAll(e);for(var t=v=e.length;t--;p.unshift(e[t]));}function s(){m=window.innerHeight||document.documentElement.clientHeight,d=window.innerWidth||document.documentElement.clientWidth}function c(e,t,n){e.attachEvent?e.attachEvent&&e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)}function i(e,t,n){e.detachEvent?e.detachEvent&&e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)}function a(e,t){if(e&&t)for(var n=e.length,r=0;n>r&&!1!==t(e[r],r);r++);}function l(e,t){var n=0;return function(){var r=+new Date;t>r-n||(n=r,e.apply(p,arguments))}}var u,f,d,m,p,v,w,h,g,y;return e.prototype.revalidate=function(){t()},e.prototype.load=function(e){-1===(" "+e.className+" ").indexOf(" "+f.successClass+" ")&&r(e)},e.prototype.destroy=function(){f.container&&a(f.container,function(e){i(e,"scroll",g)}),i(window,"scroll",g),i(window,"resize",g),i(window,"resize",y),v=0,p.length=0,h=!0},e});